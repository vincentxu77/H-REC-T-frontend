import{d as z,r as o,L,z as I,aq as O,o as R,c as A,a as t,t as a,u as U,ay as B,g as H,_ as V}from"./index-ChEthMy4.js";const D={class:"position-summary"},J={class:"summary-content"},K={class:"position-items"},X={class:"position-item"},Z={class:"value"},$={class:"position-item"},j={class:"value"},G={class:"position-item"},Q={class:"value"},Y={class:"position-item"},ee={class:"value"},te={key:0,class:"position-item"},se={class:"value"},ne={class:"right-section"},oe={class:"time-item"},ae={class:"time-value"},ie={class:"time-item"},le={class:"time-value"},re=z({__name:"PositionSummary",setup(ce,{expose:k}){const _=()=>({"CCER-12M":Math.floor(Math.random()*300)+800,"CCER-24M":Math.floor(Math.random()*200)+500,"CCER-36M":Math.floor(Math.random()*150)+200,EUA:Math.floor(Math.random()*200)+400,SAF:Math.floor(Math.random()*300)+900}),n=o(_()),N=()=>{const s=localStorage.getItem("marketPositions");if(s)try{n.value=JSON.parse(s)}catch(e){console.error("解析持仓数据失败",e),n.value=_()}},b=()=>{localStorage.setItem("marketPositions",JSON.stringify(n.value))},P=(s,e)=>{n.value[s]+=e,b()},i=s=>new Intl.NumberFormat("zh-CN").format(s);L(n,()=>{b()},{deep:!0});const u=o({hkt:"",cet:""}),y=()=>{const s=new Date;u.value.hkt=s.toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Asia/Hong_Kong"}),u.value.cet=s.toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Europe/Paris"})};let f;const m=o(null),h=o(null),l=o(!1),r=o(0),C=o(0),E=()=>{const s=m.value,e=h.value;if(!s||!e)return;const c=e.querySelector(".position-items");if(!c)return;const d=c.cloneNode(!0);e.innerHTML="",e.appendChild(d);const M=s.offsetWidth,W=d.offsetWidth,w=M-W;C.value=Math.max(24,w);const g=document.createElement("div");g.className="spacer",g.style.cssText=`
    width: ${C.value}px;
    display: inline-block;
    flex-shrink: 0;
  `,e.appendChild(g);const q=d.cloneNode(!0);e.appendChild(q),r.value=0,e.style.transform="translateX(0)"},v=()=>{const s=m.value,e=h.value;if(!s||!e||l.value)return;const c=e.querySelector(".position-items");if(!c)return;const d=c.offsetWidth,M=.5;r.value-=M,Math.abs(r.value)>=d+C.value&&(r.value=0),e.style.transform=`translateX(${r.value}px)`,requestAnimationFrame(v)},F=()=>{l.value=!0},x=()=>{l.value=!1,requestAnimationFrame(v)},S=()=>{document.hidden?l.value=!0:(l.value=!1,requestAnimationFrame(v))};let p;const T=()=>{const s=m.value;s&&(p=new ResizeObserver(()=>{E()}),p.observe(s))};return I(()=>{N(),y(),f=window.setInterval(y,1e3),E(),T(),document.addEventListener("visibilitychange",S),requestAnimationFrame(v)}),O(()=>{f&&clearInterval(f),p&&p.disconnect(),document.removeEventListener("visibilitychange",S)}),k({updatePosition:P}),(s,e)=>(R(),A("div",D,[t("div",J,[e[12]||(e[12]=t("div",{class:"left-section"},[t("div",{class:"position-item total"},[t("span",{class:"label"},"当前总持仓数")])],-1)),t("div",{ref_key:"scrollContainerRef",ref:m,class:"middle-section",onMouseenter:F,onMouseleave:x},[t("div",{ref_key:"scrollContentRef",ref:h,class:"scroll-content"},[t("div",K,[t("div",X,[e[0]||(e[0]=t("span",{class:"label"},"CCER-12M",-1)),t("span",Z,a(i(n.value["CCER-12M"])),1),e[1]||(e[1]=t("span",{class:"unit"},"手",-1))]),t("div",$,[e[2]||(e[2]=t("span",{class:"label"},"CCER-24M",-1)),t("span",j,a(i(n.value["CCER-24M"])),1),e[3]||(e[3]=t("span",{class:"unit"},"手",-1))]),t("div",G,[e[4]||(e[4]=t("span",{class:"label"},"CCER-36M",-1)),t("span",Q,a(i(n.value["CCER-36M"])),1),e[5]||(e[5]=t("span",{class:"unit"},"手",-1))]),t("div",Y,[e[6]||(e[6]=t("span",{class:"label"},"EUA",-1)),t("span",ee,a(i(n.value.EUA)),1),e[7]||(e[7]=t("span",{class:"unit"},"手",-1))]),U(B)("permission:btn:delete")?H("",!0):(R(),A("div",te,[e[8]||(e[8]=t("span",{class:"label"},"SAF",-1)),t("span",se,a(i(n.value.SAF)),1),e[9]||(e[9]=t("span",{class:"unit"},"手",-1))]))])],512)],544),t("div",ne,[t("div",oe,[e[10]||(e[10]=t("span",{class:"time-label"},"HKT",-1)),t("span",ae,a(u.value.hkt),1)]),t("div",ie,[e[11]||(e[11]=t("span",{class:"time-label"},"CET",-1)),t("span",le,a(u.value.cet),1)])])])]))}}),ue=V(re,[["__scopeId","data-v-ad1cc1be"]]);export{ue as default};
