import{d as q,r as o,L as z,z as F,aq as L,o as I,c as O,a as t,t as i,_ as U}from"./index-BUe-CBK6.js";const B={class:"position-summary"},H={class:"summary-content"},D={class:"position-items"},J={class:"position-item"},K={class:"value"},V={class:"position-item"},X={class:"value"},Z={class:"position-item"},$={class:"value"},j={class:"position-item"},G={class:"value"},Q={class:"right-section"},Y={class:"time-item"},ee={class:"time-value"},te={class:"time-item"},se={class:"time-value"},ne=q({__name:"PositionSummary",setup(oe,{expose:R}){const M=()=>({"CCER-12M":Math.floor(Math.random()*300)+800,"CCER-24M":Math.floor(Math.random()*200)+500,"CCER-36M":Math.floor(Math.random()*150)+200,EUA:Math.floor(Math.random()*200)+400}),n=o(M()),k=()=>{const s=localStorage.getItem("marketPositions");if(s)try{n.value=JSON.parse(s)}catch(e){console.error("解析持仓数据失败",e),n.value=M()}},b=()=>{localStorage.setItem("marketPositions",JSON.stringify(n.value))},A=(s,e)=>{n.value[s]+=e,b()},d=s=>new Intl.NumberFormat("zh-CN").format(s);z(n,()=>{b()},{deep:!0});const u=o({hkt:"",cet:""}),E=()=>{const s=new Date;u.value.hkt=s.toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Asia/Hong_Kong"}),u.value.cet=s.toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Europe/Paris"})};let f;const m=o(null),h=o(null),a=o(!1),l=o(0),C=o(0),y=()=>{const s=m.value,e=h.value;if(!s||!e)return;const r=e.querySelector(".position-items");if(!r)return;const c=r.cloneNode(!0);e.innerHTML="",e.appendChild(c);const _=s.offsetWidth,T=c.offsetWidth,W=_-T;C.value=Math.max(24,W);const g=document.createElement("div");g.className="spacer",g.style.cssText=`
    width: ${C.value}px;
    display: inline-block;
    flex-shrink: 0;
  `,e.appendChild(g);const w=c.cloneNode(!0);e.appendChild(w),l.value=0,e.style.transform="translateX(0)"},v=()=>{const s=m.value,e=h.value;if(!s||!e||a.value)return;const r=e.querySelector(".position-items");if(!r)return;const c=r.offsetWidth,_=.5;l.value-=_,Math.abs(l.value)>=c+C.value&&(l.value=0),e.style.transform=`translateX(${l.value}px)`,requestAnimationFrame(v)},N=()=>{a.value=!0},P=()=>{a.value=!1,requestAnimationFrame(v)},S=()=>{document.hidden?a.value=!0:(a.value=!1,requestAnimationFrame(v))};let p;const x=()=>{const s=m.value;s&&(p=new ResizeObserver(()=>{y()}),p.observe(s))};return F(()=>{k(),E(),f=window.setInterval(E,1e3),y(),x(),document.addEventListener("visibilitychange",S),requestAnimationFrame(v)}),L(()=>{f&&clearInterval(f),p&&p.disconnect(),document.removeEventListener("visibilitychange",S)}),R({updatePosition:A}),(s,e)=>(I(),O("div",B,[t("div",H,[e[10]||(e[10]=t("div",{class:"left-section"},[t("div",{class:"position-item total"},[t("span",{class:"label"},"当前总持仓数")])],-1)),t("div",{ref_key:"scrollContainerRef",ref:m,class:"middle-section",onMouseenter:N,onMouseleave:P},[t("div",{ref_key:"scrollContentRef",ref:h,class:"scroll-content"},[t("div",D,[t("div",J,[e[0]||(e[0]=t("span",{class:"label"},"CCER-12M",-1)),t("span",K,i(d(n.value["CCER-12M"])),1),e[1]||(e[1]=t("span",{class:"unit"},"手",-1))]),t("div",V,[e[2]||(e[2]=t("span",{class:"label"},"CCER-24M",-1)),t("span",X,i(d(n.value["CCER-24M"])),1),e[3]||(e[3]=t("span",{class:"unit"},"手",-1))]),t("div",Z,[e[4]||(e[4]=t("span",{class:"label"},"CCER-36M",-1)),t("span",$,i(d(n.value["CCER-36M"])),1),e[5]||(e[5]=t("span",{class:"unit"},"手",-1))]),t("div",j,[e[6]||(e[6]=t("span",{class:"label"},"EUA",-1)),t("span",G,i(d(n.value.EUA)),1),e[7]||(e[7]=t("span",{class:"unit"},"手",-1))])])],512)],544),t("div",Q,[t("div",Y,[e[8]||(e[8]=t("span",{class:"time-label"},"HKT",-1)),t("span",ee,i(u.value.hkt),1)]),t("div",te,[e[9]||(e[9]=t("span",{class:"time-label"},"CET",-1)),t("span",se,i(u.value.cet),1)])])])]))}}),ae=U(ne,[["__scopeId","data-v-09c54b3d"]]);export{ae as default};
