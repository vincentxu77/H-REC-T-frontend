import{d as w,r as o,L as q,z,aq as L,o as I,c as O,a as e,t as i,_ as U}from"./index-Dva5DfmA.js";const B={class:"position-summary"},H={class:"summary-content"},D={class:"position-items"},J={class:"position-item"},K={class:"value"},V={class:"position-item"},X={class:"value"},Z={class:"position-item"},$={class:"value"},j={class:"position-item"},G={class:"value"},Q={class:"position-item"},Y={class:"value"},tt={class:"right-section"},et={class:"time-item"},st={class:"time-value"},nt={class:"time-item"},ot={class:"time-value"},it=w({__name:"PositionSummary",setup(at,{expose:R}){const g=()=>({"CCER-12M":Math.floor(Math.random()*300)+800,"CCER-24M":Math.floor(Math.random()*200)+500,"CCER-36M":Math.floor(Math.random()*150)+200,EUA:Math.floor(Math.random()*200)+400,SAF:Math.floor(Math.random()*300)+900}),n=o(g()),A=()=>{const s=localStorage.getItem("marketPositions");if(s)try{n.value=JSON.parse(s)}catch(t){console.error("解析持仓数据失败",t),n.value=g()}},b=()=>{localStorage.setItem("marketPositions",JSON.stringify(n.value))},k=(s,t)=>{n.value[s]+=t,b()},a=s=>new Intl.NumberFormat("zh-CN").format(s);q(n,()=>{b()},{deep:!0});const u=o({hkt:"",cet:""}),E=()=>{const s=new Date;u.value.hkt=s.toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Asia/Hong_Kong"}),u.value.cet=s.toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Europe/Paris"})};let f;const m=o(null),h=o(null),l=o(!1),r=o(0),C=o(0),S=()=>{const s=m.value,t=h.value;if(!s||!t)return;const c=t.querySelector(".position-items");if(!c)return;const d=c.cloneNode(!0);t.innerHTML="",t.appendChild(d);const M=s.offsetWidth,x=d.offsetWidth,T=M-x;C.value=Math.max(24,T);const _=document.createElement("div");_.className="spacer",_.style.cssText=`
    width: ${C.value}px;
    display: inline-block;
    flex-shrink: 0;
  `,t.appendChild(_);const W=d.cloneNode(!0);t.appendChild(W),r.value=0,t.style.transform="translateX(0)"},v=()=>{const s=m.value,t=h.value;if(!s||!t||l.value)return;const c=t.querySelector(".position-items");if(!c)return;const d=c.offsetWidth,M=.5;r.value-=M,Math.abs(r.value)>=d+C.value&&(r.value=0),t.style.transform=`translateX(${r.value}px)`,requestAnimationFrame(v)},N=()=>{l.value=!0},P=()=>{l.value=!1,requestAnimationFrame(v)},y=()=>{document.hidden?l.value=!0:(l.value=!1,requestAnimationFrame(v))};let p;const F=()=>{const s=m.value;s&&(p=new ResizeObserver(()=>{S()}),p.observe(s))};return z(()=>{A(),E(),f=window.setInterval(E,1e3),S(),F(),document.addEventListener("visibilitychange",y),requestAnimationFrame(v)}),L(()=>{f&&clearInterval(f),p&&p.disconnect(),document.removeEventListener("visibilitychange",y)}),R({updatePosition:k}),(s,t)=>(I(),O("div",B,[e("div",H,[t[12]||(t[12]=e("div",{class:"left-section"},[e("div",{class:"position-item total"},[e("span",{class:"label"},"当前总持仓数")])],-1)),e("div",{ref_key:"scrollContainerRef",ref:m,class:"middle-section",onMouseenter:N,onMouseleave:P},[e("div",{ref_key:"scrollContentRef",ref:h,class:"scroll-content"},[e("div",D,[e("div",J,[t[0]||(t[0]=e("span",{class:"label"},"CCER-12M",-1)),e("span",K,i(a(n.value["CCER-12M"])),1),t[1]||(t[1]=e("span",{class:"unit"},"手",-1))]),e("div",V,[t[2]||(t[2]=e("span",{class:"label"},"CCER-24M",-1)),e("span",X,i(a(n.value["CCER-24M"])),1),t[3]||(t[3]=e("span",{class:"unit"},"手",-1))]),e("div",Z,[t[4]||(t[4]=e("span",{class:"label"},"CCER-36M",-1)),e("span",$,i(a(n.value["CCER-36M"])),1),t[5]||(t[5]=e("span",{class:"unit"},"手",-1))]),e("div",j,[t[6]||(t[6]=e("span",{class:"label"},"EUA",-1)),e("span",G,i(a(n.value.EUA)),1),t[7]||(t[7]=e("span",{class:"unit"},"手",-1))]),e("div",Q,[t[8]||(t[8]=e("span",{class:"label"},"SAF",-1)),e("span",Y,i(a(n.value.SAF)),1),t[9]||(t[9]=e("span",{class:"unit"},"手",-1))])])],512)],544),e("div",tt,[e("div",et,[t[10]||(t[10]=e("span",{class:"time-label"},"HKT",-1)),e("span",st,i(u.value.hkt),1)]),e("div",nt,[t[11]||(t[11]=e("span",{class:"time-label"},"CET",-1)),e("span",ot,i(u.value.cet),1)])])])]))}}),rt=U(it,[["__scopeId","data-v-e76914b6"]]);export{rt as default};
